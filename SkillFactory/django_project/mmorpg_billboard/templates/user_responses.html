{% extends 'base.html' %}
{%block title %}Мои отклики{% endblock %}
{% block content %}
<h2>Мои отклики</h2>

<div class="filter">
    <form method="get">
        <select name="announcement_id" onchange="this.form.submit()">
            <option value="all" {% if not request.GET.announcement_id or request.GET.announcement_id == 'all' %}selected{% endif %}>Все объявления</option>
            {% for announcement in announcements %}
                <option value="{{ announcement.id }}"
                {% if request.GET.announcement_id == announcement.id|stringformat:"s" %}selected{% endif %}>
                    {{ announcement.title }}
                </option>
            {% endfor %}
        </select>
    </form>
</div>

<div class="responses-list">
    {% for response in responses %}
        <div class="response">
            <h3>{{ response.announcement.title }}</h3>
            <p>{{ response.text }}</p>
            <p>От: {{ response.user.username }}</p>
            <p>Дата: {{ response.created_at }}</p>

            {% if not response.is_accepted %}
            <a href="{% url 'accept_response' response.announcement.pk response.pk %}" class="btn btn-success"><button>Принять</button></a>
            {% else %}
                <span class="accepted">Отклик принят</span>
            {% endif %}

            <a href="{% url 'delete_response' response.id %}" class="btn btn-danger"
               onclick="return confirm('Вы уверены, что хотите удалить отклик?')"><button>Удалить</button></a>
        </div>
    {% empty %}
        <p>Откликов нет</p>
    {% endfor %}
</div>

{% if messages %}
    <div class="messages">
        {% for message in messages %}
            <div class="alert alert-{{ message.tags }}">
                {{ message }}
            </div>
        {% endfor %}
    </div>
{% endif %}
{% endblock %}
